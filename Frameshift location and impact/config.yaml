# ========= 1) genome / annotation =========
genome_fasta: "./mm39.fa"   # Adjust based on species. Requires indexed genome fasta (*.fa.fai) in the same folder
gtf: "./mm39.ncbiRefSeq.gtf" # or any Refseq style gtf from UCSC genome browser

# Transcript selection for per-gene model
transcript_choice: "longest_cds"         # "longest_cds" | "NM_only" | "whitelist"
transcript_whitelist: null               # path to a list, if you use "whitelist"
name_normalization: true                 # normalize gene/transcript IDs
split_by_direction: true                 # create UP/DOWN sets from logFC in the CSV

# --- Optional context outputs from frameshift_loci.py (already wired) ---
emit_context:
  enable_sequences: true                 # requires genome_fasta + .fai
  flank_nt: 9
  enable_codon_tokens: true              # in-frame codon tokens around locus
  flank_codons: 3
  save_window_fasta: false               # write per-comparison FASTA of windows

structure_scan:
  enable: true                           # downstream ΔG via RNAfold
  offset_nt: [6, 18]                     # start positions (nt) to scan downstream
  window_nt: 30
  rnafold_bin: "RNAfold"
  # NOTE: "gquad" is not used by the current function. If you need it, we must extend
  # rnafold_min_dG() to add --gquad and parse output.
  # gquad: true

stall_codon_scan:
  enable: true
  proline_runs: [2, 3]                   # PP, PPP
  polybasic_min: 6                       # >=6 K or R in a row
  de_to_p: true                          # D/E immediately followed by P
  # dicodons_file, require_in_frame are not used by the current script; can be added later.

# ========= 2) samples ========= adjust to full location of your aligned bams
groups:
  Sham:
    - "./Sham1.bam"
    - "./Sham2.bam"
    - "./Sham3.bam"
    - "./Sham4.bam"
  H1:
    - "./1hr1.bam"
    - "./1hr2.bam"
    - "./1hr3.bam"
    - "./1hr4.bam"
  H6:
    - "./6hr1.bam"
    - "./6hr2.bam"
    - "./6hr3.bam"
    - "./6hr4.bam"
  H24:
    - "./24hr1.bam"
    - "./24hr2.bam"
    - "./24hr3.bam"
    - "./24hr4.bam"

comparisons: # This is the location of the output files generated after the differential analysis performed on frameshift score (FS) using Limma-trend. 
  - case: H1
    control: Sham
    sig_genes_csv: "./frameshift_differential/H1-Sham_MW.csv"
  - case: H6
    control: Sham
    sig_genes_csv: "./frameshift_differential/H6-Sham_MW.csv"
  - case: H24
    control: Sham
    sig_genes_csv: "./frameshift_differential/H24-Sham_MW.csv"

# ========= 3) P-site offsets =========
psite_offsets_dir: "/frameshift/psite_offsets" # P-site offsets generated by frameshift.py script
default_chosen_ext: "5end"               # if your offsets were computed on 5' ends
min_read_length: 25
max_read_length: 36
# If BAM basenames differ from offset prefixes, map them here:
psite_name_map: {}                       # e.g. {"24hr1":"24hr_1"}  (empty is fine if names match)

# ========= 4) calling knobs =========
min_total_reads_per_gene_per_group: 20   # gene-level gate for both case and control
min_persistence_codons: 6                # sustained off-frame run length (you set 3; 6 is stricter)
codon_bin_smoothing: 1                   # simple 3-bin smoothing for plotting only
allow_multiple_loci: true
locus_refit_mask_nt: 90                  # mask ± this span when searching a 2nd locus

# Stats thresholds
gtest_alpha: 0.05
min_window_reads: 30                     # minimum reads inside the candidate window
#HMM windows
analysis_window:
  flank_up_codons: 10      # codons upstream of slip seed
  flank_down_codons: 10    # codons downstream of slip seed
  use_min_seed: true       # shrink to min_persistence_codons, not full run

# ========= 5) multiprocessing =========
max_workers: 5

# ========= 6) post_fs_context knobs  ====
context:
  flank_nt: 20               # overrides top-level flank_nt if present
  max_window_nt: 81
  run_rnafold: true
  rnafold_temp_c: 37.0
  save_rnafold_raw: false
  run_rnaplfold: true        # accessibility / opening energies
  rnaplfold:
    u_lengths: [10,20,30]    # report PU for these window lengths
    L: 120                   # max base pair span for local folding
    W: 200                   # sliding window
    extra_args: []           # e.g., ["--nofile"]
  gquad:
    enable: true
    pattern: "(G{3,})[ACGU]{1,7}(G{3,})[ACGU]{1,7}(G{3,})[ACGU]{1,7}(G{3,})"  # PQS regex
  shuffles:
    enable: true
    n: 200                   # number of dinucleotide-preserving shuffles
    seed: 13
  motifs:
    expand: true             # enable extended motif families
    aa_context: true         # amino-acid context (Pro-runs, polybasic, D/E->P) if codon tokens available
    kmer_discovery:
      enable: true
      nt_k: [6,7,8]
      codon_k: [2,3]
      export_fasta: true     # write plus1/minus1 FASTA for Motif analysis using MEME or other tools


